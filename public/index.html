<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Firebase</title>
  </head>
  <body>
    <h1>Welcome to Firebase</h1>
    <h3>Have fun with firebase</h3>
    <ul>

    </ul>
  </body>

  <script src="https://www.gstatic.com/firebasejs/5.10.0/firebase.js"></script>
  <script>
    // Initialize Firebase
    var config = {
      apiKey: "AIzaSyA128tacCTrHdf3uBxUJpQjEE9mIwvatKQ",
      authDomain: "firstpro-2d6e9.firebaseapp.com",
      databaseURL: "https://firstpro-2d6e9.firebaseio.com",
      projectId: "firstpro-2d6e9",
      storageBucket: "firstpro-2d6e9.appspot.com",
      messagingSenderId: "557425118479"
    };
    firebase.initializeApp(config);

    // reference database
    var db = firebase.database();
    var playersRef = db.ref('players');
    // var playersRef = db.ref('topscorers');

    // show data
    // playersRef.on('value', showData, showError);

    // Notification
    // playersRef.on('child_added', userAdded);
    // playersRef.on('child_changed', userChanged);

    //filter and sort
    //orderByKey orderByChild orderByValue
    playersRef.orderByChild('no').on('value', showData, showError);
    // playersRef.orderByValue().on('value', showData, showError);

    //limit startAt() endAt(i) equalTo(i) limitToFirst(i) limitToLast(i)
    // playersRef.orderByValue().limitToLast(2).on('value', showData, showError);

    //add data (create daya)
    // playersRef.on('child_added',addData);

    // SET (rewrite data - delete old data)
    // playersRef.set({
    //   4: {
    //     name : "alba",
    //     no: 4
    //   }
    // })

    //PUSH : not rewrite and generate auto id
    // playersRef.push({
    //   name : "pique",
    //   skill : "tackle",
    //   no: 5,
    // })

    //UPDATE : add or edit
    // playersRef.update({
    //   3: {
    //     name : "neymar",
    //     skill : "diving",
    //     no : 11
    //   }
      // "1/name" : "Messi",
      // "2/name" : "Suarez",
    // })

    // Remove data
    playersRef.on('child_removed',removedData);
    playersRef.child(3).remove()

    function addData(){
      console.log('Congratulations, success add data!')
    }

    function removedData(){
      console.log('Congratulations, success removed data!')
    }

    function showData(items){
      // console.log(items.val())

      var _ul = document.getElementsByTagName('ul')[0];
      var _content = '';

      items.forEach(function(child){
        // orderby Child
        _content += "<li>" + child.val().name + " - " + child.val().no + "</li>";

        //orderby Value
        // _content += "<li>" + child.key + " - " + child.val() + "</li>";
      })

      _ul.innerHTML = _content;
    }

    function userAdded(items){
      console.log("Congratulation! success add user")
      console.log(items.val())
    }

    function userChanged(items){
      console.log("Congratulation! success changed user " + items.val().name)
    }

    function showError(items){
      console.log(err)
    }

  </script>

</html>
